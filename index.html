<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>US Map (D3)</title>
  <style>
    :root {
      --bg: #f7f3ea;
      --ink: #1f1f1f;
      --land: #2b2d42;
      --stroke: #f7f3ea;
      --hover: #ef8354;
    }
    body {
      margin: 0;
      font-family: "Georgia", "Times New Roman", serif;
      background: radial-gradient(circle at 20% 20%, #fff6e0, var(--bg));
      color: var(--ink);
    }
    header {
      padding: 24px 24px 8px 24px;
    }
    h1 {
      margin: 0 0 6px 0;
      font-size: 26px;
      letter-spacing: 0.2px;
    }
    p {
      margin: 0;
      opacity: 0.75;
    }
    #map {
      display: block;
      width: 100vw;
      height: 70vh;
    }
    .state {
      fill: var(--land);
      stroke: var(--stroke);
      stroke-width: 0.8;
      vector-effect: non-scaling-stroke;
      transition: fill 120ms ease;
    }
    .state:hover {
      fill: var(--hover);
      cursor: pointer;
    }
    .tooltip {
      position: absolute;
      pointer-events: none;
      background: rgba(255, 255, 255, 0.92);
      border: 1px solid #ddd;
      padding: 6px 8px;
      border-radius: 6px;
      font-size: 12px;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
    }
  </style>
</head>
<body>
  <header>
    <h1>US States</h1>
    <p>D3 + GeoJSON rendering (run from a local server).</p>
  </header>

  <svg id="map" role="img" aria-label="Map of the United States"></svg>
  <div id="tooltip" class="tooltip" style="opacity: 0"></div>

  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script>
    const svg = d3.select("#map");
    const tooltip = d3.select("#tooltip");

    const width = svg.node().clientWidth;
    const height = svg.node().clientHeight;

    const projection = d3.geoAlbersUsa()
      .translate([width / 2, height / 2])
      .scale(Math.min(width, height) * 1.2);

    const path = d3.geoPath(projection);

    fetch("us-states.geojson")
      .then(response => {
        if (!response.ok) throw new Error("Failed to load GeoJSON");
        return response.json();
      })
      .then(data => {
        svg
          .append("g")
          .selectAll("path")
          .data(data.features)
          .join("path")
          .attr("class", "state")
          .attr("d", path)
          .on("mousemove", (event, d) => {
            tooltip
              .style("opacity", 1)
              .style("left", `${event.pageX + 12}px`)
              .style("top", `${event.pageY - 12}px`)
              .text(d.properties.name);
          })
          .on("mouseleave", () => {
            tooltip.style("opacity", 0);
          });
      })
      .catch(err => {
        console.error(err);
        alert("Could not load the GeoJSON. Make sure you are using a local server.");
      });

    window.addEventListener("resize", () => location.reload());
  </script>
</body>
</html>
