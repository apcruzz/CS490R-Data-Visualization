<!-- <!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>US Map (D3)</title>

  <style>
    :root {
      --bg: #f7f3ea;
      --ink: #1f1f1f;
      --land: #2b2d42;
      --stroke: #f7f3ea;
      --hover: #ef8354;
    }

    body {
      margin: 0;
      font-family: "Georgia", "Times New Roman", serif;
      background: radial-gradient(circle at 20% 20%, #fff6e0, var(--bg));
      color: var(--ink);
    }

    header {
      padding: 24px 24px 8px 24px;
    }

    h1 {
      margin: 0 0 6px 0;
      font-size: 26px;
    }

    p {
      margin: 0;
      opacity: 0.75;
    }

    #map {
      display: block;
      width: 100vw;
      height: 70vh;
    }

    .state {
      fill: var(--land);
      stroke: var(--stroke);
      stroke-width: 0.8;
      vector-effect: non-scaling-stroke;
      transition: fill 120ms ease;
    }

    .state:hover {
      fill: var(--hover);
      cursor: pointer;
    }

    .tooltip {
      position: absolute;
      pointer-events: none;
      background: rgba(255,255,255,0.95);
      border: 1px solid #ddd;
      padding: 6px 8px;
      border-radius: 6px;
      font-size: 12px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.12);
    }
  </style>
</head>

<body>

<header>
  <h1>US States</h1>
  <p>D3 + GeoJSON rendering</p>
</header>

<svg id="map"></svg>
<div id="tooltip" class="tooltip" style="opacity:0"></div>

<script src="https://d3js.org/d3.v7.min.js"></script>

<script>
const svg = d3.select("#map");
const tooltip = d3.select("#tooltip");

function drawMap() {

  svg.selectAll("*").remove();

  const width = svg.node().clientWidth;
  const height = svg.node().clientHeight;

  fetch("us-states.json")
    .then(r => r.json())
    .then(data => {

      // â­ AUTO FIT PROJECTION
      const projection = d3.geoAlbersUsa()
        .fitSize([width, height], data);

      const path = d3.geoPath(projection);

      svg.append("g")
        .selectAll("path")
        .data(data.features)
        .join("path")
        .attr("class", "state")
        .attr("d", path)
        .on("mousemove", (event, d) => {
          tooltip
            .style("opacity", 1)
            .style("left", (event.pageX + 12) + "px")
            .style("top", (event.pageY - 12) + "px")
            .text(d?.properties?.name || "State");
        })
        .on("mouseleave", () => {
          tooltip.style("opacity", 0);
        });

    });
}

drawMap();
window.addEventListener("resize", drawMap);
</script>

<script src="https://gist.github.com/wboykinm/6979292.js"></script>

</body>
</html> -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>US States (Leaflet w/ AK & HI Insets)</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

  <style>
    :root{
      --bg:#f7f3ea;
      --ink:#1f1f1f;
      --land:#2b2d42;
      --stroke:#f7f3ea;
      --hover:#ef8354;
    }

    body{
      margin:0;
      font-family:"Georgia","Times New Roman",serif;
      background: radial-gradient(circle at 20% 20%, #fff6e0, var(--bg));
      color:var(--ink);
    }

    header{
      padding:24px 24px 8px 24px;
    }

    h1{ margin:0 0 6px 0; font-size:26px; }
    p{ margin:0; opacity:.75; }

    /* Container holds main map + inset maps */
    .map-wrap{
      position:relative;
      width:100vw;
      height:70vh;
    }

    #map{
      position:absolute;
      inset:0;
      background:transparent;
    }

    .leaflet-container{ background:transparent; }

    /* Insets bottom-right */
    .inset{
      position:absolute;
      right:16px;
      bottom:16px;
      display:flex;
      gap:12px;
      z-index:999; /* above map */
      pointer-events:auto;
    }

    .inset-map{
      width:180px;
      height:120px;
      border-radius:12px;
      box-shadow:0 10px 24px rgba(0,0,0,.14);
      border:1px solid rgba(255,255,255,.65);
      background: rgba(255,255,255,0.08);
      overflow:hidden;
    }

    .leaflet-tooltip.state-tooltip{
      background: rgba(255,255,255,0.95);
      border: 1px solid #ddd;
      padding: 6px 8px;
      border-radius: 6px;
      font-size: 12px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.12);
      color: #111;
    }
  </style>
</head>

<body>
  <header>
    <h1>US States</h1>
    <p>Leaflet + GeoJSON (Lower 48 + Alaska/Hawaii insets)</p>
  </header>

  <div class="map-wrap">
    <div id="map"></div>

    <div class="inset">
      <div id="map-ak" class="inset-map" title="Alaska"></div>
      <div id="map-hi" class="inset-map" title="Hawaii"></div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <script>
    // ---- Styles (match your D3 colors) ----
    function baseStyle(){
      const css = getComputedStyle(document.documentElement);
      return {
        color: css.getPropertyValue("--stroke").trim(),
        weight: 1,
        fillColor: css.getPropertyValue("--land").trim(),
        fillOpacity: 0.95
      };
    }

    function hoverStyle(){
      const css = getComputedStyle(document.documentElement);
      return {
        color: "#ffffff",
        weight: 2,
        fillColor: css.getPropertyValue("--hover").trim(),
        fillOpacity: 1
      };
    }

    function attachInteractions(feature, layer){
      const name = feature?.properties?.name || feature?.id || "State";

      layer.bindTooltip(name, {
        sticky: true,
        direction: "auto",
        className: "state-tooltip"
      });

      layer.on("mouseover", () => layer.setStyle(hoverStyle()));
      layer.on("mouseout", () => layer.setStyle(baseStyle()));
    }

    // ---- Create 3 maps: main + 2 insets ----
    const mainMap = L.map("map", {
      zoomControl: false,
      attributionControl: false,
      preferCanvas: true,
      dragging: true,
      scrollWheelZoom: true
    });

    const akMap = L.map("map-ak", {
      zoomControl: false,
      attributionControl: false,
      preferCanvas: true,
      dragging: false,
      scrollWheelZoom: false,
      doubleClickZoom: false,
      boxZoom: false,
      keyboard: false,
      tap: false
    });

    const hiMap = L.map("map-hi", {
      zoomControl: false,
      attributionControl: false,
      preferCanvas: true,
      dragging: false,
      scrollWheelZoom: false,
      doubleClickZoom: false,
      boxZoom: false,
      keyboard: false,
      tap: false
    });

    // Optional: stop clicks on inset from panning main map (extra safe)
    L.DomEvent.disableClickPropagation(document.getElementById("map-ak"));
    L.DomEvent.disableClickPropagation(document.getElementById("map-hi"));

    // ---- Load GeoJSON once, split into layers ----
    fetch("us-states.json") // <-- your file name
      .then(r => r.json())
      .then(data => {

        const isAK = f => (f?.properties?.name === "Alaska" || f?.id === "02");
        const isHI = f => (f?.properties?.name === "Hawaii" || f?.id === "15");
        const isDC = f => (f?.properties?.name === "District of Columbia" || f?.id === "11");

        // Lower 48 = everything except Alaska & Hawaii (keep DC if you want)
        const lower48 = {
          type: "FeatureCollection",
          features: data.features.filter(f => !isAK(f) && !isHI(f))
        };

        const alaska = {
          type: "FeatureCollection",
          features: data.features.filter(isAK)
        };

        const hawaii = {
          type: "FeatureCollection",
          features: data.features.filter(isHI)
        };

        // --- Main layer (lower 48) ---
        const lowerLayer = L.geoJSON(lower48, {
          style: baseStyle,
          onEachFeature: attachInteractions
        }).addTo(mainMap);

        mainMap.fitBounds(lowerLayer.getBounds(), { padding: [20, 20] });

        // --- Alaska inset ---
        const akLayer = L.geoJSON(alaska, {
          style: baseStyle,
          onEachFeature: attachInteractions
        }).addTo(akMap);

        if (akLayer.getBounds().isValid()) {
          akMap.fitBounds(akLayer.getBounds(), { padding: [10, 10] });
        }

        // --- Hawaii inset ---
        const hiLayer = L.geoJSON(hawaii, {
          style: baseStyle,
          onEachFeature: attachInteractions
        }).addTo(hiMap);

        if (hiLayer.getBounds().isValid()) {
          hiMap.fitBounds(hiLayer.getBounds(), { padding: [10, 10] });
        }

        // ---- "Zoom it in" a bit like D3's framing ----
        // After fitting, zoom in one level for a tighter look:
        mainMap.setZoom(mainMap.getZoom() + 1);

      })
      .catch(err => console.error("Failed to load us-states.json:", err));
  </script>
</body>
</html>
